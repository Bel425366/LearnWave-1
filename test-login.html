<!DOCTYPE html>
<html>
<head>
    <title>Teste Login</title>
</head>
<body>
    <h1>Teste de Login</h1>
    <button onclick="testarLogin()">Testar Login</button>
    <div id="resultado"></div>

    <script>
        async function testarLogin() {
            const resultado = document.getElementById('resultado');
            
            try {
                // Primeiro, vamos cadastrar um usuário de teste
                console.log('Cadastrando usuário de teste...');
                const cadastroResponse = await fetch('http://localhost:8080/api/usuarios', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome: 'Teste Usuario',
                        email: 'teste@teste.com',
                        senha: '123456',
                        tipo: 'aluno'
                    })
                });
                
                console.log('Cadastro response:', cadastroResponse.status);
                if (cadastroResponse.ok) {
                    const cadastroData = await cadastroResponse.json();
                    console.log('Cadastro data:', cadastroData);
                } else {
                    const cadastroError = await cadastroResponse.text();
                    console.log('Cadastro error:', cadastroError);
                }
                
                // Agora vamos tentar fazer login
                console.log('Tentando fazer login...');
                const loginResponse = await fetch('http://localhost:8080/api/usuarios/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'teste@teste.com',
                        senha: '123456',
                        tipo: 'aluno'
                    })
                });
                
                console.log('Login response status:', loginResponse.status);
                
                if (loginResponse.ok) {
                    const loginData = await loginResponse.json();
                    console.log('Login success:', loginData);
                    resultado.innerHTML = '<p style="color: green;">Login realizado com sucesso!</p>';
                } else {
                    const loginError = await loginResponse.text();
                    console.log('Login error:', loginError);
                    resultado.innerHTML = `<p style="color: red;">Erro no login: ${loginError}</p>`;
                }
                
            } catch (error) {
                console.error('Erro:', error);
                resultado.innerHTML = `<p style="color: red;">Erro: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>